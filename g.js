"use strict";function _possibleConstructorReturn(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _get=function t(i,e,s){null===i&&(i=Function.prototype);var h=Object.getOwnPropertyDescriptor(i,e);if(void 0===h){var a=Object.getPrototypeOf(i);return null===a?void 0:t(a,e,s)}if("value"in h)return h.value;var n=h.get;if(void 0!==n)return n.call(s)},_createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();window.$={},$.cols={black:"#000",ash:"#9d9d9d",blind:"#fff",bloodred:"#be2633",pigmeat:"#e06f8b",oldpoop:"#493C2B",newpoop:"#a46422",blaze:"#eb8931",zornskin:"#f7e26b",shadegreen:"#2f484e",leafgreen:"#44891A",slimegreen:"#A3CE27",nightblue:"#1B2632",seablue:"#005784",skyblue:"#31A2F2",cloudblue:"#B2DCEF"},window.addEventListener("load",function(){new Game},!1),$.data={title:"Whiskey Fever"},$.loadCallback=function(t){"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(t){console.log("Successfully registered service worker",t)})["catch"](function(t){console.warn("Error registering service worker",t)}),window.addEventListener("online",function(t){console.log("online"),Page.hideOfflineWarning(),Arrivals.loadData()},!1),window.addEventListener("offline",function(t){console.log("offline")},!1),navigator.onLine},$.data.i={circle:"R0lGODlhCAAIAIABAP///zGi8iH5BAEKAAEALAAAAAAIAAgAAAIOTIBgp+ybFmwyzodmDgUAOw==",cloud:"R0lGODlhMAAKAMIFAAAAABsmMi9ITr4mM52dnf///////////yH5BAEKAAcALAAAAAAwAAoAAANoeLrc/jDGQIO8D2hwg/iCNVWUBAzowEEe+IlO68LNmaIrQ7kzvfMvmuZ20yxkBFfypZABQSKbqpjiOJcfbAipJWADUpy46HxCy9symMiuHtQ/5nt2hCrCqqG7STpWdH18JQsbRncbCgkAOw==",drop:"R0lGODlhBgAIAKECAOuJMffia////////yH5BAEKAAIALAAAAAAGAAgAAAINlGGJugKPoIQhgspMAQA7",font:"R0lGODlhjwAFAIABAAAAAP///yH5BAEKAAEALAAAAACPAAUAAAJzDGKHcLzOFDRJ0UbXzdJ2lFQbRo5ipJ1TA7XsW2KanNWyZXpuzuNSz5txQDZTChSrsI6kXfOHDNmcl9+LKXxiU7fHBwV2zFxJzwZbGiazq+kyqua2h0I6vEhLh977Dm1fBaW1BvUwYmYY16UiuDN29VhRAAA7",grass:"R0lGODlhoAAqAMIHAEk8K6RkIkSJGuBvi6DO5LLc7/fiazGi8iH5BAEKAAcALAAAAACgACoAAAPseLqsMy3KSau9GBuTu//PJ44kKQilsqXMSblss8Y0Bpc3mzd73NctlE+II/JOxhdyyWw6n9CoFDatWq9Y6yPL7V4DgSp4PP6Sy17kGexdu93S9/NNr9vv+Lx+z+/73wCBgnSChX+HAYWDiHqLYIaJigCPjo5ukGOShJpklmuDi5idkoqjk5SToaSrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc7P0NHS09TV1tfY2drb3N3e3+Dh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7/AAMKHEiwoMGDCBN6SwAAOw==",heart:"R0lGODlhBQAFAKECAL4mM+Bvi////////yH5BAEKAAEALAAAAAAFAAUAAAIIDGygu3mBQgEAOw==",hills:"R0lGODlhoABDAIABAKDO5DGi8iH5BAEKAAEALAAAAACgAEMAAALnTICpC+YPo5y02ouz3pL533DiSJYmCabMybbuW6nyAtf2nc16gvf+vQuGfsSiSBg0KpcxZJIJZTqF0WpxSrVqgdjs9svqIsHkknhcTmvOaLWbwva+54+4nD633/Fq/f70xAfntzNCSCN4WGihuNjXKNMB2UWk4jAZeYCpZ1O4+QnKExZKWuq4YZqqarm26vqK2AQ7CztIe/sagbs7e8n7u6oJPExcbHyMnKy8zNzs/AwdLT1NXW19jZ2tvc3d7f0NHi4+Tl5ufo6err7O3u7+Dh8vP09fb3+Pn6+/z9/v/w8woMCBmAoAADs=",icon:"R0lGODlhBgAHAMIGAAUDCzWADOuJMffia/3//P///zGi8jGi8iH5BAEKAAcALAAAAAAGAAcAAAMReLGhvEeQUYQS2GHR3jnAFyYAOw==",lightning:"R0lGODlhBQAZAIAAADGi8jGi8iH5BAEKAAEALAAAAAAFABkAAAIYTGCGudcAlXwnVduuZFghGHGduDmkhaIFADs=",p1:"R0lGODlhJAAIAMIHAAAAAAUDCzWADOuJMffia/3//P///zGi8iH5BAEKAAcALAAAAAAkAAgAAANSeLonLizKSCpRD2Y3gQfYc1jWBg1FVTTi95ljalyoyg4Dmx1AARiggUVBwuByD5xRyfssc6TKLaeDTJuu62hYPQQW3y4WJL6MFN/wJA1Gu9WRBAA7"},$.data.sfx={jump:[0,,.2432,,.1709,.3046,,.1919,,,,,,.5923,,,,,1,,,,,.5],powerup:[0,,.0129,.5211,.4714,.4234,,,,,,.4355,.5108,,,,,,1,,,,,.5],explode:[3,,.3708,.5822,.3851,.0584,,-.0268,,,,-.0749,.7624,,,,,,1,,,,,.5],levelup:[2,.0506,.8811,.0789,.9412,.5002,,.001,.3829,.0595,.4632,-.812,.7855,-.9121,.1173,.1088,-.3698,.1704,.8458,-.2283,,.1259,-.0298,.5],die:[2,.1987,.388,.4366,.0335,.5072,,.1128,-.1656,.1987,,-.376,.2686,-.684,.1392,-.6819,-.8117,-.1072,.9846,.057,,.004,-.0045,.56],drip:[2,,.096,.0306,.1507,.5682,,.062,.1642,.7539,.4601,.3383,.2139,,-.947,.3561,.0282,1e-4,.9998,.1985,.4432,6e-4,-.136,.5],fart:[0,.25,.86,.66,.84,.22,,-.3199,.0022,-.0131,.9164,.3911,,.7873,.4686,,.2566,.0307,.8693,.8432,.7706,.4253,-.0044,.5],tap:[1,,.1953,,.1186,.2659,,,,,,,,,,,,,1,,,.1,,.5],gameover:[0,.4581,.0141,.2338,.2849,.5105,,.002,-.2648,.952,,.3003,.0379,,-.0021,,-.0559,.3951,.9529,-.2469,.1062,.0043,-.0155,.6],drink:[0,,.0119,.91,.21,.5,,.1399,,.49,.07,.32,,,.08,,,,1,,,,,.82]},$.H={listen:function(t,i){window.addEventListener(t,i,!1)},el:function(t){return document.getElementById(t)},rnd:function(t,i){return Math.floor(Math.random()*(i-t+1)+t)},rndArray:function(t){return t[~~(Math.random()*t.length)]},textWidth:function(t,i){return t.length*(3*i.scale)+t.length*(1*i.scale)},timeStamp:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},tween:function(t,i,e,s){return e*t/s+i},shuffle:function(t){var i,e,s;for(s=t.length;s;s--)i=Math.floor(Math.random()*s),e=t[s-1],t[s-1]=t[i],t[i]=e;return t},mkFavicon:function(t){var i=document.createElement("canvas");i.width=i.height=64;var e=i.getContext("2d");e.drawImage(t,0,0);var s=document.createElement("link");s.type="image/x-icon",s.rel="shortcut icon",s.href=i.toDataURL("image/x-icon"),document.getElementsByTagName("head")[0].appendChild(s)},mkCanvas:function(t,i){var e=document.createElement("canvas"),s=e.getContext("2d");return e.width=t,e.height=i,s.mozImageSmoothingEnabled=!1,s.imageSmoothingEnabled=!1,e},resize:function(t,i,e){i=i||1,e=e||!1;var s=t.width*i,h=t.height*i,a=document.createElement("canvas");a.width=t.width,a.height=t.height;var n=a.getContext("2d");n.drawImage(t,0,0);var r=n.getImageData(0,0,t.width,t.height),o=document.createElement("canvas");o.width=s,o.height=h;var l,c,u=o.getContext("2d"),g=u.getImageData(0,0,s,h);for(l=0;l<h;l++)for(c=0;c<s;c++){var d=4*(Math.floor(l/i)*t.width+Math.floor(c/i)),f=4*(l*s+c);g.data[f]=r.data[d],g.data[f+1]=r.data[d+1],g.data[f+2]=r.data[d+2],g.data[f+3]=r.data[d+3],0===r.data[d+3]?(g.data[f]=0,g.data[f+1]=0,g.data[f+2]=0,g.data[f+3]=0):e&&(g.data[f]=e[0],g.data[f+1]=e[1],g.data[f+2]=e[2],g.data[f+3]=255)}u.putImageData(g,0,0);var p=new Image;return p.src=o.toDataURL("image/png"),p}};var Load=function(){function t(i){_classCallCheck(this,t),this.g=i,this.imgsLoaded=0,this.imgsTotal=Object.keys($.data.i).length,this.loadImages()}return _createClass(t,[{key:"loadImages",value:function(){var t,i=this.g,e="data:image/gif;base64,",s=$.data.i;for(t in s)s.hasOwnProperty(t)&&(i.imgs[t]=new Image,i.imgs[t].onload=this.checkLoaded(),i.imgs[t].src=e+s[t])}},{key:"checkLoaded",value:function(){var t=this,i=(this.g,this);this.imgsLoaded+=1,i.imgsLoaded===i.imgsTotal&&window.setTimeout(function(){t.mkFonts(),$.loadCallback(t.g)},900)}},{key:"mkFonts",value:function(){var t=this.g,i={b:[0,0,0],w:[255,255,255],g:[68,137,26],lg:[163,206,39],r:[190,38,51],y:[247,226,107],o:[235,137,49],p:[224,111,139]},e=t.imgs,s=void 0;for(s in i)t.fonts[s]=$.H.resize(t.imgs.font,1,i[s]);for(s in e)e[s+"_w"]=$.H.resize(e[s],1,[255,255,255]);window.setTimeout(function(){t.init()},250)}}]),t}();$.Audio={init:function(t){var i=AudioContext||webkitAudioContextx;this.ctx=!!i&&new i,this.g=t,this.ctx&&this.encode()},encode:function(){var t=this;t.sounds=[];var i=function(t){var i,e,s;for(t=jsfxr(t),t=atob(t.substr(t.indexOf(",")+1)),i=t.length,e=new Uint8Array(i),s=0;s<i;s++)e[s]=t.charCodeAt(s);return e.buffer},e=function(e){t.ctx.decodeAudioData(i($.data.sfx[e]),function(i){t.sounds[e]=i})};for(var s in $.data.sfx)e(s)},play:function(t){if(this.ctx&&this.sounds[t]){var i=this.ctx.createBufferSource();i.buffer=this.sounds[t],i.connect(this.ctx.destination),i.start(0)}},say:function(t){var i=arguments.length<=1||void 0===arguments[1]?1.1:arguments[1];if(!this.g.firefox){var e=new SpeechSynthesisUtterance(t);e.lang="en-US",e.rate=i,e.pitch=.1,window.speechSynthesis.speak(e)}}};var Game=function(){function t(){_classCallCheck(this,t);var i=navigator.userAgent.toLowerCase(),e=void 0,s=void 0;this.l=document.getElementById("l"),this.h=document.getElementById("h"),e=320,s=480,this.c=document.getElementsByTagName("canvas")[0],this.ctx=this.c.getContext("2d"),this.w=e,this.h=s,this.c.width=e,this.c.height=s,this.c.style.width=e+"px",this.c.style.height=s+"px",this.dt=0,this.fps=60,this.frameStep=1/this.fps,this.frameCurr=0,this.framePrev=$.H.timeStamp(),this.mobile="createTouch"in document||!1,this.android=i.indexOf("android")>-1,this.ios=/ipad|iphone|ipod/.test(i),this.firefox=i.indexOf("firefox")>-1,this.plays=0,this.events=[],this.ents=[],this.imgs=[],this.fonts=[],this.sfx=[],document.title=$.data.title,this.load()}return _createClass(t,[{key:"load",value:function(){this.draw=new Draw(this.ctx,this.w,this.h),this.input=new Input(this),this.emitter=new Emitter(this),this.shake=new Shake(this),this.ios?this.audio={play:function(){},say:function(){}}:(this.audio=$.Audio,this.audio.init(this)),this.load=new Load(this)}},{key:"init",value:function(){var t=this;this.scale(),$.H.mkFavicon(this.draw.scale(this.imgs.icon,8)),this.changeState("Title"),this.loop(),window.addEventListener("resize",function(){return t.scale()},!1)}},{key:"loop",value:function(){var t=this;for(this.frameCurr=$.H.timeStamp(),this.dt=this.dt+Math.min(1,(this.frameCurr-this.framePrev)/1e3),this.c.className="",this.input.poll();this.dt>this.frameStep;)this.dt=this.dt-this.frameStep,this.state.update(this.frameStep);this.shake.update(this.dt),this.state.render(this.dt),this.framePrev=this.frameCurr,requestAnimationFrame(function(){return t.loop()})}},{key:"update",value:function(t){var i=!0,e=!1,s=void 0;try{for(var h,a=this.ents[Symbol.iterator]();!(i=(h=a.next()).done);i=!0){var n=h.value;n.update(t)}}catch(r){e=!0,s=r}finally{try{!i&&a["return"]&&a["return"]()}finally{if(e)throw s}}}},{key:"render",value:function(){this.draw.clear();var t=!0,i=!1,e=void 0;try{for(var s,h=this.ents[Symbol.iterator]();!(t=(s=h.next()).done);t=!0){var a=s.value;a.render()}}catch(n){i=!0,e=n}finally{try{!t&&h["return"]&&h["return"]()}finally{if(i)throw e}}}},{key:"scale",value:function(){this.scalePortrait()}},{key:"scalePortrait",value:function(){var t=window.innerHeight,i=this.w/this.h,e=t*i;e/this.w;this.mobile&&t<window.innerWidth?(this.l.style.display="block",$.H.el("h").innerHTML="Rotate Device",this.c.style.display="none"):(this.l.style.display="none",this.c.style.display="block"),window.navigator.standalone===!0&&this.ios||(this.c.width=this.w,this.c.height=this.h,this.cx=this.w/2,this.cy=this.h/2,this.c.style.width=~~e+"px",this.c.style.height=~~t+"px")}},{key:"changeState",value:function(t){switch(this.ents=[],this.events=[],t){case"Title":this.state=new Title(this);break;case"Intro":this.state=new Intro(this);break;case"Splash":this.state=new Splash(this);break;case"Play":this.state=new Play(this)}}},{key:"mkFont",value:function(t,i){var e=this,s=e.draw.scale(e.fonts[t],i);return s.scale=i,s}},{key:"addEvent",value:function(t){this.events.push(t)}}]),t}(),State=function(){function t(i){_classCallCheck(this,t),this.g=i,this.init()}return _createClass(t,[{key:"init",value:function(){this.bgCol=!1,this.fader=0}},{key:"update",value:function(t){for(var i=this.g,e=i.ents.length;e--;)i.ents[e].update(t);for(e=i.ents.length;e--;)i.ents[e].remove&&i.ents.splice(e,1);for(e=i.events.length;e--;){var s=i.events[e];if(!s)break;s.time-=t,s.time<0&&(s.cb.call(this),i.events.splice(e,1))}this.fader=Math.sin(.005*(new Date).getTime())}},{key:"render",value:function(){var t=this.g.ents.length;for(this.bgCol&&this.g.draw.clear(this.bgCol),t=0;t<this.g.ents.length;t+=1)this.g.ents[t].render()}}]),t}(),Input=function(){function t(i){var e=this;_classCallCheck(this,t);var s=window.addEventListener;this.g=i,this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.m={x:i.w/2,y:i.h/2,click:0},this.keys={up:0,down:0,left:0,right:0,shoot:0,enter:0},this.keyMappings={up:38,down:40,left:37,right:39,shoot:32,enter:13},s("keydown",function(t){return e.press(t,1)},!1),s("keyup",function(t){return e.press(t,0)},!1),s("mousemove",function(t){return e.trackMove(t)},!1),s("mousedown",function(t){return e.m.click=1},!1),s("mouseup",function(t){return e.m.click=0},!1),s("touchstart",function(t){e.m.click=1,e.trackMove(t.touches[0])},!1),s("touchend",function(t){e.m.click=0,e.trackMove(t.touches[0])},!1),s("touchmove",function(t){t.preventDefault(),e.trackMove(t.touches[0])},!1)}return _createClass(t,[{key:"poll",value:function(){}},{key:"press",value:function(t,i){for(var e in this.keyMappings)t.keyCode===this.keyMappings[e]&&(this.keys[e]=i)}},{key:"trackMove",value:function(t){var i=this.g,e=i.c.offsetTop,s=i.c.offsetLeft,h=parseInt(i.c.style.width,10)/i.c.width,a=~~((t.pageX-s)/h),n=~~((t.pageY-e)/h);a=a>i.w?i.w:a,a=a<0?0:a,n=n>i.h?i.h:n,n=n<0?0:n,this.m.x=~~a,this.m.y=~~n}}]),t}(),Draw=function(){function t(i,e,s){_classCallCheck(this,t),this.ctx=i,this.w=e,this.h=s}return _createClass(t,[{key:"clear",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"#000":arguments[0];this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.w,this.h)}},{key:"rect",value:function(t,i,e,s,h){this.ctx.fillStyle=h,this.ctx.fillRect(t,i,e,s)}},{key:"circle",value:function(t,i,e){this.ctx.beginPath(),this.ctx.fillStyle="#fff",this.ctx.arc(t,i,e,0,2*Math.PI),this.ctx.closePath()}},{key:"scale",value:function(t,i,e){var s=$.H.mkCanvas(t.width*i,t.height*i),h=s.getContext("2d");return s.width&&(h.save(),h.scale(i,i),h.drawImage(t,0,0),h.restore()),s}},{key:"flip",value:function(t,i,e){var s=$.H.mkCanvas(t.width,t.height),h=s.getContext("2d"),a=i?-1:1,n=e?-1:1,r=i?t.width*-1:0,o=e?t.height*-1:0;return s.width=t.width,s.height=t.height,h.save(),h.scale(a,n),h.drawImage(t,r,o,t.width,t.height),h.restore(),s}},{key:"text",value:function(t,i,e,s,h){var a=0,n=this.ctx,r=65,o=0,l=3*i.scale,c=5*i.scale,u=1*i.scale,g=$.H.textWidth(t,i),d=0;for("number"!=typeof t&&"0"!==t[0]||(t+="",o=43),e=e||(this.w-g)/2,h&&(this.text(t,h.f,e+h.offset,s),this.text(t,h.f,e-h.offset,s),this.text(t,h.f,e,s+h.offset),this.text(t,h.f,e,s-h.offset)),a=0;a<t.length;a+=1)d=(t.charCodeAt(a)-r+o)*(l+u),d>-1&&n.drawImage(i,d,0,l,c,~~e,~~s,l,c),e+=l+u}}]),t}(),Sprite=function(){function t(i){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,t),this.g=i,this.dead=!1,this.remove=!1,this.id=Date.now()+"-"+i.ents.length,this.angle=0,this.lastPos={x:this.x,y:this.y},this.flip={x:0,y:0},this.restrict=!0,this.scale=e.scale||1,this.frame=e.frame||1,this.frames=e.frames||1,this.frameRate=e.frameRate||80,this.frameNext=e.frameNext||0;for(var s in e)this[s]=e[s];this.o=e,e.i&&this.mkImg(e.i),this.bound=e.bound||{w:this.w,h:this.h,x:0,y:0},this.init()}return _createClass(t,[{key:"init",value:function(){this.anims={idle:{frames:[1],rate:80}},this.changeAnim("idle")}},{key:"update",value:function(t){this.lastPos.x=this.x,this.lastPos.y=this.y,this.collidesWith&&this.hitGroup(this.collidesWith),this.updateAnim(t),this.updateMove(t),this.restrict&&this.restrictToScreen(),this.gravity&&(this.vy+=this.gravity*this.g.dt)}},{key:"updateAnim",value:function(t){this.frameNext<0&&(this.frameNext=this.anim.rate,this.anim.counter+=1,this.anim.counter>=this.anim.frames.length&&(this.anim.next?this.changeAnim(this.anim.next):this.anim.counter=0),this.frame=this.anim.frames[this.anim.counter]),this.frameNext-=1e3*t}},{key:"updateMove",value:function(t){}},{key:"restrictToScreen",value:function(){this.x<0&&(this.x=0),this.x>this.g.w-this.w&&(this.x=this.g.w-this.w),this.y>this.g.h-this.h&&(this.y=this.g.h-this.h)}},{key:"render",value:function(){var t=this.g,i=this.i,e=this.frame;i?(this.flip.y&&(i=t.draw.flip(i,0,1)),this.flip.x&&(i=t.draw.flip(i,1,0),e=this.frames-this.frame+1),t.ctx.drawImage(i,e*this.w-this.w,0,this.w,this.h,~~this.x,~~this.y,this.w,this.h)):this.g.draw.rect(~~this.x,~~this.y,this.w,this.h,this.col)}},{key:"doDamage",value:function(t){}},{key:"receiveDamage",value:function(t){}},{key:"kill",value:function(){this.dead=!0,this.remove=!0}},{key:"hitGroup",value:function(t){for(var i=this.g,e=i.ents.length;e--;)i.ents[e]&&i.ents[e].group===t&&i.ents[e].id!==this.id&&this.hit(i.ents[e])&&i.ents[e].dead===!1&&(this.doDamage(i.ents[e]),i.ents[e].receiveDamage(this))}},{key:"hit",value:function(t){return!(t.y+t.h<this.y||t.y>this.y+this.h||t.x+t.w<this.x||t.x>this.x+this.w)}},{key:"mkImg",value:function(t){var i=this.g;this.i=i.draw.scale(i.imgs[t],this.scale),this.w=this.i.width/this.frames,this.h=this.i.height,this.iHurt=i.draw.scale(i.imgs[t+"_w"],this.scale)}},{key:"changeAnim",value:function(t){this.anim&&this.anim.name&&this.anim.name===t||(this.anim=this.anims[t],this.anim.name=t,this.anim.counter=0,this.frame=this.anim.frames[0],this.frameNext=this.anim.rate)}},{key:"rotate",value:function(t,i){var e=document.createElement("canvas"),s=e.getContext("2d"),h=Math.max(t.width,t.height)+6;i*(180/Math.PI);return e.width=h,e.height=h,s.translate(h/2,h/2),s.rotate(i+Math.PI/2),s.drawImage(t,-(t.width/2),-(t.height/2)),e}}]),t}(),Particle=function(t){function i(t,e){_classCallCheck(this,i);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.name="particle",s.scale=1,s.group="na",s.w=4,s.h=4,s.lifespan=$.H.rnd(20,50),s.ttl=s.lifespan,s.alpha=1,s.vx=e.vx||$.H.rnd(0,300)-300,s.vy=e.vy||$.H.rnd(0,300)*-1,s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(t){_get(Object.getPrototypeOf(i.prototype),"update",this).call(this,t),this.x+=this.vx*t,this.y+=this.vy*t,this.ttl-=1,this.ttl<0&&(this.remove=!0)}},{key:"render",value:function(){var t=this.g;t.ios||t.draw.rect(this.x,this.y,5,5,$.cols[this.col])}}]),i}(Sprite),Emitter=function(){function t(i){_classCallCheck(this,t),this.g=i}return _createClass(t,[{key:"particle",value:function(t,i,e){var s=arguments.length<=3||void 0===arguments[3]?["ash"]:arguments[3],h=this.g,a=void 0;for(a=0;a<t;a+=1){var n=$.H.rndArray(s),r=6/t*a;h.ents.push(new Particle(h,{x:i,y:e,col:n,vx:300*Math.cos(r),vy:300*Math.sin(r)}))}}},{key:"explosion",value:function(t,i,e,s,h){for(var a=this.g,n=$.H.rnd;t--;)window.setTimeout(function(){a.ents.push(new Explosion(a,{x:i+n(-10,10),y:e+n(-10,10),magnitude:h,particles:s}))},150*t)}}]),t}(),Shake=function(){function t(i){_classCallCheck(this,t),this.g=i,this.c=i.c,this.ttl=0,this.mag=0}return _createClass(t,[{key:"start",value:function(t,i){this.mag=t,this.ttl=i,this.l=(window.innerWidth-this.c.style.width)/2}},{key:"update",value:function(){var t=(this.g,this.c),i=$.H.rnd(-this.mag,this.mag);this.ttl-=1,this.g.ios||(0===this.ttl?(t.style.marginLeft=this.l+"px",t.style.marginTop="0px"):this.ttl>0&&(t.style.marginTop=i+"px",t.style.marginLeft=i+this.l+"px"))}}]),t}(),Button=function(t){function i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,i),e.size=e.size||4,e.w=e.w||150,e.h=e.h||50,e.delay=e.delay||100,e.col=e.col||$.cols.slimegreen,e.triggerOnEnter=e.triggerOnEnter||!1,e.fadeIn=e.fadeIn||0;var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.p=t.mkFont("w",e.size),s.pHover=t.mkFont("b",e.size),s.boxX=~~(s.g.w/2-s.w/2),s.boxY=s.y-15,s.clicked=!1,s.clickCol=e.clickCol||"#fff",s.currentCol=s.col,s.clicked=!1,s.fontCol="p",s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(){var t=this,i=this.g.input.m.click;this.fontCol="p",this.fadeIn-=1,this.hover=this.intersects(),this.hover&&(this.g.c.className="hover",this.fontCol="pHover"),this.currentCol=this.hover||this.hover&&i?this.clickCol:this.col,(!this.clicked&&this.hover&&i||!this.clicked&&this.triggerOnEnter&&this.g.input.keys.enter)&&(this.g.audio.play("tap"),this.clicked=!0,setTimeout(function(){t.cb.call()},this.delay))}},{key:"render",value:function(){var t=this.hover?this.pHover:this.p;this.g.draw.rect(this.boxX,this.boxY,this.w,this.h,this.currentCol),this.g.draw.text(this.text,t,this.x,this.y)}},{key:"intersects",value:function(){var t=this.g.input.m;return t.x>this.boxX&&t.x<this.boxX+this.w&&t.y>this.boxY&&t.y<this.boxY+this.h}}]),i}(Sprite),Bonus=function(t){function i(t,e){_classCallCheck(this,i),e.group="bonus",e.vx=$.H.rnd(-40,40),e.vy=-100,e.w=10,e.w=10,e.scale=1,e.i="circle",e.alpha=1;var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.fader=0,s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(t){this.mkImg("circle"),this.fader=Math.sin(.002*(new Date).getTime()),(this.y<0||this.alpha<=.1)&&this.kill(),this.x+=this.vx*t+this.fader,this.y+=this.vy*t,this.alpha-=.01}},{key:"render",value:function(){this.g.ctx.globalAlpha=this.alpha,this.g.ctx.drawImage(this.iHurt,this.x,this.y),this.g.ctx.globalAlpha=1}}]),i}(Sprite),Cloud=function(t){function i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,i),e.w=16,e.h=16,e.group="cloud",e.collidesWith="baddie",e.frames=3,e.scale=4,e.vx=4,e.vy=4,e.i="cloud";var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.dir=1,s.changeDir=30,s.drop=20,s.lightning=0,s.hasShocked=0,s.x=t.w/2-s.w/2,s}return _inherits(i,t),_createClass(i,[{key:"init",value:function(){this.anims={idle:{frames:[1],rate:100},laugh:{frames:[1,2],rate:100},burp:{frames:[2],rate:50,next:"idle"},rage:{frames:[3],rate:100,next:"idle"}},this.changeAnim("idle")}},{key:"update",value:function(t){return this.p.gameOver?void(this.x<this.g.player.x-this.w/2+5?this.x+=1:this.x>this.g.player.x-this.w/2+5?this.x-=1:0!==this.lightning||this.hasShocked?0===this.lightning&&this.hasShocked?this.g.player.dead===!1&&(this.changeAnim("laugh"),this.g.player.kill()):this.lightning-=1:(this.g.lightning=this.g.ents.push(new Lightning(this.g,{x:this.x,y:this.y+this.h-0})),this.lightning=80,this.hasShocked=!0,this.g.shake.start(50,30),this.g.player.changeAnim("fry"))):void(this.p.spilt||this.p.inWave<0||(this.x<=0?this.dir=1:this.x>=this.g.w-this.w&&(this.dir=-1),this.changeDir<=0&&(this.vx=~~(4*Math.random())+this.p.wave,this.dir=this.dir*-1,this.changeDir=~~(Math.random()*(this.g.w-this.w)/2)),this.drop<=0&&(this.drop=$.H.rnd(15,30),this.p.doDrop()),this.x+=this.dir*this.vx,this.updateAnim(t),this.changeDir--,this.drop--))}},{key:"render",value:function(){_get(Object.getPrototypeOf(i.prototype),"render",this).call(this)}}]),i}(Sprite),Drop=function(t){function i(t,e){_classCallCheck(this,i),e.vx=0,e.vy=0,e.gravity=100,e.scale=3,e.i="drop",e.group="baddie";var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.name="drop",s}return _inherits(i,t),_createClass(i,[{key:"updateMove",value:function(t){return!!this.p.spilt||(this.x+=this.vx*t,this.y+=this.vy*t,this.vy+=this.gravity*t,void((this.y>this.p.floor+4||this.p.gameOver)&&(this.dead=!0,this.g.audio.play("drip"),this.g.shake.start(30,20),this.explode(),this.p.doSpill())))}},{key:"explode",value:function(){this.kill(),this.g.cloud.changeAnim("rage"),this.g.emitter.particle(5,this.x+this.w/2,this.y+this.h/2,["blaze"])}},{key:"receiveDamage",value:function(t){var i="drink";this.kill(),this.g.audio.play(i),this.g.score+=1,this.g.player.changeAnim("gulp"),this.g.ios||this.g.ents.push(new Bonus(this.g,{x:this.x,y:this.y}))}},{key:"kill",value:function(){this.p.inWave-=1,_get(Object.getPrototypeOf(i.prototype),"kill",this).call(this)}}]),i}(Sprite),Label=function(t){function i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,i);var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.h1=s.g.mkFont("w",5),s.p=s.g.mkFont("r",3),s.w=150,s.h=120,s.destX=85,s.distX=0,s.x=-10,s.y=220,s.vx=1,s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(t){this.distX=this.destX-this.x,this.x=$.H.tween(33,this.x,this.distX,this.speed)}},{key:"render",value:function(){this.g.draw.rect(this.x,this.y,150,120,$.cols.black),this.g.draw.text("WHISKEY",this.h1,this.x+8,this.y+30),this.g.draw.text("F E V E R",this.p,this.x+18,this.y+70)}}]),i}(Sprite),Explosion=function(t){function i(t,e){_classCallCheck(this,i);e.i="circle";var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.name="explosion",s.group="na",s.startX=e.x,s.startY=e.y,s.particles=e.particles||3,s.magnitude=e.magnitude||9,s.factor=1,s.angle=0,s.grow=1,s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(){this.g;_get(Object.getPrototypeOf(i.prototype),"update",this).call(this),this.scale<=this.magnitude&&(this.scale+=this.factor),this.scale===this.magnitude&&(this.factor*=-1),this.scale<=1&&(this.remove=!0),this.mkImg("circle")}},{key:"render",value:function(){var t=this.startX-this.w/2,i=this.startY-this.h/2,e=this.g,s=this.i;e.ctx.drawImage(s,t,i)}}]),i}(Sprite),Lightning=function(t){function i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,i),e.vx=0,e.vy=0,e.scale=13,e.i="lightning",e.name=e.i;var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.invert=$.H.rnd(30,50),s.g.audio.play("explode"),s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(){this.invert--,0===this.invert&&(this.flip.x=0===this.flip.x?1:0,this.invert=$.H.rnd(30,50)),this.g.player.dead&&this.kill(),_get(Object.getPrototypeOf(i.prototype),"update",this).call(this)}}]),i}(Sprite),P1=function(t){function i(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,i),e.w=16,e.h=16,e.group="player",e.collidesWith="baddie",e.frames=6,e.scale=4,e.i="p1";var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.x=t.w/2-s.w/2,s}return _inherits(i,t),_createClass(i,[{key:"init",value:function(){this.anims={walk:{frames:[2,1],rate:80},fry:{frames:[6,4],rate:80},stand:{frames:[1,1,1,5,1,1],rate:200},gulp:{frames:[3],rate:100,next:"stand"}},this.changeAnim("walk")}},{key:"updateMove",value:function(){var t=(this.g.input.keys,this.g.input.m);if(!this.p.gameOver){if(this.p.spilt)return void this.changeAnim("gulp");this.x=t.x-this.w/2,this.lastPos.x<this.x?this.flip.x=0:this.lastPos.x>this.x&&(this.flip.x=1),this.lastPos.x!==this.x&&"walk"!==this.anim.name&&"gulp"!==this.anim.name?this.changeAnim("walk"):this.lastPos.x===this.x&&"gulp"!==this.anim.name&&this.changeAnim("stand")}}},{key:"render",value:function(){_get(Object.getPrototypeOf(i.prototype),"render",this).call(this)}},{key:"receiveDamage",value:function(t){console.log(t.group)}},{key:"doDamage",value:function(t){t.kill()}},{key:"kill",value:function(){this.g.audio.play("die"),this.g.emitter.particle(20,this.x+this.w/2,this.y+this.h/2,["slimegreen","bloodred"]),_get(Object.getPrototypeOf(i.prototype),"kill",this).call(this)}}]),i}(Sprite),Sky=function(){function t(i,e){_classCallCheck(this,t),this.g=i,this.p=e,this.cols=["ash","blind"],this.changeStep=10,this.change=0,this.col=$.H.rndArray(this.cols)}return _createClass(t,[{key:"update",value:function(){this.p.spilt&&(this.change-=1,this.change<=0&&(this.change=this.changeStep,this.col=$.H.rndArray(this.cols)))}},{key:"render",value:function(){this.p.spilt?this.g.draw.clear($.cols[this.col]):this.g.player.dead?this.g.draw.clear($.cols.black):this.p.gameOver&&this.g.draw.clear($.cols.ash)}}]),t}(),Text=function(t){function i(t,e){_classCallCheck(this,i),e.group="text",e.vy=e.vy||-10,e.vx=e.vx||0,e.w=10,e.w=10,e.o=1,e.alpha=1,e.scale=e.scale||4,e.col=e.col||"w",e.accel=e.accel||.5;var s=_possibleConstructorReturn(this,Object.getPrototypeOf(i).call(this,t,e));return s.p=t.mkFont(e.col,e.scale),s}return _inherits(i,t),_createClass(i,[{key:"update",value:function(t){(this.y<0||this.alpha<.1)&&this.kill(),this.vy-=this.accel,this.alpha-=.01,this.vx&&(this.x+=this.vx*t),this.y+=this.vy*t}},{key:"render",value:function(){this.text?(this.g.ctx.globalAlpha=this.alpha,this.g.draw.text(this.text,this.p,this.x,this.y),this.g.ctx.globalAlpha=1):this.o&&this.g.ctx.drawImage(this.i,this.x,this.y)}}]),i}(Sprite),Title=function(t){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,Object.getPrototypeOf(i).apply(this,arguments))}return _inherits(i,t),_createClass(i,[{key:"init",value:function(){var t=this;this.g.hiScore||(this.g.hiScore=20);var i=0===this.g.plays?"Intro":"Play",e=0===this.g.plays?1.5:.5;this.bgCol=$.cols.nightblue,this.hi=this.g.mkFont("w",3),this.sm=this.g.mkFont("w",2),this.g.addEvent({time:e,cb:function(){t.g.ents.push(new Button(t.g,{y:380,triggerOnEnter:!0,col:$.cols.leafgreen,state:i,text:"PLAY",cb:function(){t.g.changeState(i)}})),t.g.ents.push(new Button(t.g,{y:450,size:2,clickCol:$.cols.blaze,col:$.cols.blaze,state:i,text:"BY EOINMCG",cb:function(){window.location="//twitter.com/eoinmcg"}}))}}),this.g.ents.push(new Label(this.g,{p:this,speed:this.g.plays>0?100:1500})),this.bubble()}},{key:"render",value:function(){this.g.draw.clear(this.bgCol),this.g.draw.rect(125,70,70,100,$.cols.blaze),this.g.draw.rect(60,170,200,330,$.cols.blaze),this.g.draw.text("HI ",this.hi,20,20),this.g.draw.text(this.g.hiScore,this.hi,50,20);var t=!0,i=!1,e=void 0;try{for(var s,h=this.g.ents[Symbol.iterator]();!(t=(s=h.next()).done);t=!0){var a=s.value;a.render()}}catch(n){i=!0,e=n}finally{try{!t&&h["return"]&&h["return"]()}finally{if(i)throw e}}this.g.draw.rect(0,170,60,330,this.bgCol)}},{key:"bubble",value:function(){var t=this;this.g.addEvent({time:$.H.rnd(.4,.9),cb:function(){t.bubble()}}),this.g.ents.push(new Bonus(this.g,{x:$.H.rnd(120,170),y:50}))}}]),i}(State),Intro=function(t){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,Object.getPrototypeOf(i).apply(this,arguments))}return _inherits(i,t),_createClass(i,[{key:"init",value:function(){var t=this;this.p=this.g.mkFont("w",4),this.hills=this.g.draw.scale(this.g.imgs.hills,2),this.grass=this.g.draw.scale(this.g.imgs.grass,2),this.floor=377,this.p1=new P1(this.g,{x:100,y:this.floor,p:this}),this.g.ents.push(this.p1),this.cloud=new Sprite(this.g,{x:0,y:50,p:this,frames:3,scale:4,i:"cloud"}),this.cloud.x=this.g.w/2-this.cloud.w/2,this.g.ents.push(this.cloud),this.flip=0,this.addText("OHAI",.1),this.addText("BEJAYSUS",2),this.addText("LOOK UP",3),this.addText("WHISKEY CLOUD",4),this.addText("LIQUID GOLD",6),this.addText("RAINING FROM ABOVE",7),this.addText("DRINK UP BOYO",8),this.addText("DONT",10,4,"r"),this.addText("SPILL",10.7,4,"r"),this.addText("A",11.4,4,"r"),this.addText("DROP",12.1,4,"r"),this.g.addEvent({time:15,cb:function(){console.log("OK"),t.g.changeState("Play")}}),this.skip=this.g.ents.push(new Button(this.g,{y:450,triggerOnEnter:!1,col:$.cols.oldpoop,state:"Play",text:"SKIP",cb:function(){t.g.changeState("Play")}}))}},{key:"update",value:function(t){_get(Object.getPrototypeOf(i.prototype),"update",this).call(this,t),this.p1.changeAnim("stand"),this.p1.x=this.g.w/2-this.p1.w/2,this.p1.flip.x=this.flip}},{key:"render",value:function(t){this.g.draw.clear($.cols.cloudblue),this.g.ctx.drawImage(this.hills,0,290),this.g.ctx.drawImage(this.grass,0,400);var i=!0,e=!1,s=void 0;try{for(var h,a=this.g.ents[Symbol.iterator]();!(i=(h=a.next()).done);i=!0){var n=h.value;n.render()}}catch(r){e=!0,s=r}finally{try{!i&&a["return"]&&a["return"]()}finally{if(e)throw s}}}},{key:"addText",value:function(t,i){var e=this,s=arguments.length<=2||void 0===arguments[2]?3:arguments[2],h=arguments.length<=3||void 0===arguments[3]?"w":arguments[3];this.g.addEvent({time:i,cb:function(){e.g.audio.play("tap"),e.g.ents.push(new Text(e.g,{x:!1,y:350,text:t,scale:s,col:h})),e.flip=e.flip?0:1}})}}]),i}(State),Play=function(t){function i(){return _classCallCheck(this,i),
_possibleConstructorReturn(this,Object.getPrototypeOf(i).apply(this,arguments))}return _inherits(i,t),_createClass(i,[{key:"init",value:function(){this.g.plays+=1,this.gameOver=!1,this.floor=377,this.p=this.g.mkFont("r",7),this.g.player=new P1(this.g,{x:100,y:this.floor,p:this}),this.g.ents.push(this.g.player),this.g.cloud=new Cloud(this.g,{x:100,y:50,p:this}),this.g.ents.push(this.g.cloud),this.g.audio.play("levelup"),this.hills=this.g.draw.scale(this.g.imgs.hills,2),this.grass=this.g.draw.scale(this.g.imgs.grass,2),this.heart=this.g.draw.scale(this.g.imgs.heart,4),this.g.lives=2,this.g.score=0,this.scoreFont=this.g.mkFont("w",4),this.spilt=!1,this.sky=new Sky(this.g,this),this.wave=0,this.startWave()}},{key:"update",value:function(t){var e=this;_get(Object.getPrototypeOf(i.prototype),"update",this).call(this,t),this.g.lives<0&&!this.gameOver&&(this.g.audio.play("gameover"),this.g.player.changeAnim("gulp"),this.gameOver=!0,this.g.score>this.g.hiScore&&(this.g.hiScore=this.g.score,this.g.ents.push(new Text(this.g,{x:!1,y:350,text:"NEW HISCORE",scale:6,col:"w"}))),this.g.addEvent({time:3,cb:function(){e.startButton=e.g.ents.push(new Button(e.g,{y:280,triggerOnEnter:!0,col:$.cols.pigmeat,state:"Play",text:"RETRY",cb:function(){e.g.audio.play("tap"),e.g.changeState("Play")}})),e.quitButton=e.g.ents.push(new Button(e.g,{y:360,col:$.cols.skyblue,state:"Title",text:"TWEET",cb:function(){window.location="https://twitter.com/intent/tweet?&text=I+scored+"+e.g.score+"+in+Whiskey+Fever&via=eoinmcg&url=https%3A%2F%2Feoinmcg.github.io%2Fwhiskey"}}))}})),this.inWave<0&&!this.waveInterval&&(this.waveInterval=!0,this.g.addEvent({time:2,cb:function(){e.startWave()}})),this.sky.update()}},{key:"render",value:function(){this.g.draw.clear($.cols.cloudblue),this.g.ctx.drawImage(this.hills,0,290),this.sky.render(),this.g.ctx.drawImage(this.grass,0,400);var t=!0,i=!1,e=void 0;try{for(var s,h=this.g.ents[Symbol.iterator]();!(t=(s=h.next()).done);t=!0){var a=s.value;a.render()}}catch(n){i=!0,e=n}finally{try{!t&&h["return"]&&h["return"]()}finally{if(i)throw e}}this.gameOver&&this.fader>0&&this.g.draw.text("GAME OVER",this.p,!1,200);for(var r=0;r<this.g.lives;r+=1)this.g.ctx.drawImage(this.heart,220+27*r,20);this.g.draw.text(this.g.score,this.scoreFont,20,20)}},{key:"doSpill",value:function(){var t=this;this.spilt=!0,this.g.addEvent({time:.5,cb:function(){t.explodeDrips()}})}},{key:"explodeDrips",value:function(){var t=0,i=!1;for(t=0;t<this.g.ents.length;t+=1)if("drop"===this.g.ents[t].name){i=!0,this.g.audio.play("drip"),this.g.ents[t].explode(),this.doSpill();break}i||(this.spilt=!1,this.g.lives-=1,1!==this.wave&&(this.wave-=2,this.startWave()))}},{key:"spawn",value:function(){var t=this,i=($.H.rnd(2,6),$.H.rnd(.5,2.5));this.gameOver||this.inWave<0||this.g.addEvent({time:i,cb:function(){!t.gameOver&&t.inWave>=0&&(t.spawn(),t.spilt||(t.g.cloud.changeAnim("burp"),t.g.audio.play("fart"),t.g.ents.push(new Drop(t.g,{p:t,x:t.g.cloud.x+t.g.cloud.w/2,y:t.g.cloud.y+t.g.cloud.h}))))}})}},{key:"startWave",value:function(){var t=0;this.wave+=1,this.inWave=1+2*this.wave,this.waveInterval=!1,t=this.wave<8?this.wave/10:1.5,this.g.player.vx=this.wave>2?6:4,this.delay={min:.5,max:2.6-t}}},{key:"doDrop",value:function(){this.spilt||(this.g.cloud.changeAnim("burp"),this.g.audio.play("fart"),this.g.ents.push(new Drop(this.g,{p:this,x:this.g.cloud.x+this.g.cloud.w/2,y:this.g.cloud.y+this.g.cloud.h})))}}]),i}(State);